---
# ============================================================================
# vLLM Performance Testing - Main Inventory File
# ============================================================================
#
# QUICK START:
# 1. Replace the IP addresses below with your actual DUT and Load Generator IPs
# 2. Update ansible_user and ansible_ssh_private_key_file if different
# 3. Set HF_TOKEN environment variable (if using gated models): export HF_TOKEN=hf_xxxxx
# 4. Run tests!
#
# Configuration files are now organized in group_vars/ directory:
#   - group_vars/all/infrastructure.yml  - Platform and container settings
#   - group_vars/all/endpoints.yml       - vLLM server and endpoint mode
#   - group_vars/all/benchmark-tools.yml - GuideLLM and vllm_bench config
#   - group_vars/all/credentials.yml     - HuggingFace token setup
#   - group_vars/all/test-workloads.yml  - Test configurations
#   - group_vars/all/hardware-profiles.yml - CPU/NUMA templates
#
# See inventory/README.md for detailed documentation
# ============================================================================

# ============================================================================
# HOST CONFIGURATION - ⚠️ CHANGE THESE VALUES ⚠️
# ============================================================================

all:
  children:
    # DUT (Device Under Test) - Runs vLLM server
    dut:
      hosts:
        my-dut:
          # ⚠️ CHANGE: Your DUT's IP address or hostname
          ansible_host: host.example.com

          # ⚠️ CHANGE: SSH user (common: ec2-user, ubuntu, root)
          ansible_user: user

          # ⚠️ CHANGE: Path to SSH private key
          ansible_ssh_private_key_file: file.pem

    # Load Generator - Runs benchmarking tools (GuideLLM, vllm bench serve)
    load_generator:
      hosts:
        my-loadgen:
          # ⚠️ CHANGE: Your Load Generator's IP address or hostname
          ansible_host: localhost
          ansible_connection: local
          ansible_python_interpreter: auto_silent  # Suppress Python interpreter discovery warnings

          # ⚠️ CHANGE: SSH user
          ansible_user: user

          # ⚠️ CHANGE: Path to SSH private key
          ansible_ssh_private_key_file: file.pem

          # Benchmark configuration
          bench_config:
            # ⚠️ CHANGE: DUT's IP (use private IP if same VPC, otherwise public IP)
            vllm_host: host.example.com  # Should match DUT's ansible_host
            vllm_port: 8000

            # Results storage location on load generator
            # On macOS with Podman, use $HOME subdirectory for VM compatibility
            results_dir: "{{ lookup('env', 'HOME') }}/benchmark-results"

# ============================================================================
# USAGE EXAMPLES
# ============================================================================
#
# 1. Test Ansible connectivity:
#    ansible -i inventory/hosts.yml all -m ping
#
# 2. Run platform setup (one-time, requires reboot):
#    ansible-playbook -i inventory/hosts.yml playbooks/common/setup-platform.yml
#    ansible -i inventory/hosts.yml all -b -m reboot
#
# 3. Run auto-configured test (simple):
#    export HF_TOKEN=hf_xxxxx  # If using gated models
#    ansible-playbook -i inventory/hosts.yml \
#      playbooks/llm/run-guidellm-test-auto.yml \
#      -e "test_model=meta-llama/Llama-3.2-1B-Instruct" \
#      -e "workload_type=summarization" \
#      -e "requested_cores=16"
#
# 4. Run manual-configured test:
#    export HF_TOKEN=hf_xxxxx  # If using gated models
#    ansible-playbook -i inventory/hosts.yml \
#      playbooks/llm/run-guidellm-test.yml \
#      -e "test_model=meta-llama/Llama-3.2-1B-Instruct" \
#      -e "workload_type=summarization" \
#      -e "core_config_name=16cores-single-socket"
#
# 5. Run core sweep (test multiple core counts):
#    export HF_TOKEN=hf_xxxxx  # If using gated models
#    ansible-playbook -i inventory/hosts.yml \
#      playbooks/llm/run-core-sweep-auto.yml \
#      -e "test_model=meta-llama/Llama-3.2-1B-Instruct" \
#      -e "workload_type=summarization" \
#      -e "requested_cores_list=[8,16,32,64]"
#
# ============================================================================
